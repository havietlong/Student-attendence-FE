<app-sidebar></app-sidebar>
<div class="container py-4">
    <div class="row mb-4 ml-5" *ngIf="showWarning">
        <div class="col-md-12">
            <div class="alert alert-warning d-flex justify-content-between align-items-center" role="alert">
                <div>
                    <i class="bi bi-exclamation-triangle-fill me-2"></i>
                    B·∫°n ch∆∞a ƒëƒÉng k√Ω ƒë·ªß s·ªë l∆∞·ª£ng h·ªçc ph·∫ßn y√™u c·∫ßu!
                </div>
                <div [routerLink]="['/course-registration']" class="btn btn-sm btn-warning">ƒêƒÉng k√Ω ngay</div>
            </div>
        </div>
    </div>
    <div class="row mb-4 ml-5">

        <!-- Profile Card -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-body d-flex align-items-center">
                    <img [src]="userImageLink" alt="Avatar" class="rounded-circle me-3" width="80" height="80">
                    <div>
                        <h5 class="card-title">{{ student.fullName }}</h5>
                        <p class="card-text mb-1">L·ªõp: {{ student.class }}</p>
                        <!-- <p class="card-text mb-1">GPA: <strong>{{ student.gpa }}</strong></p>
                        <div class="mb-2">
                            <div class="progress" style="height: 8px">
                                <div class="progress-bar bg-success" role="progressbar"
                                    [style.width]="(student.gpa / 4.0) * 100 + '%'" aria-valuemin="0" aria-valuemax="4">
                                </div>
                            </div>
                        </div>
                        <p class="card-text">T·ªïng t√≠n ch·ªâ: {{ student.totalCredits }}</p> -->
                        <button [routerLink]="['/student-profile/'+studentId]"
                            class="btn btn-outline-primary btn-sm mt-2">Th√¥ng tin c√° nh√¢n</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Today‚Äôs Classes -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">L·ªãch h·ªçc h√¥m nay</h5>

                    <ul class="list-group list-group-flush" *ngIf="todayClasses.length > 0; else noClasses">
                        <li class="list-group-item" *ngFor="let cls of todayClasses">
                            <strong>{{ cls.subject }}</strong><br>
                            <small>{{ cls.time }} - Ph√≤ng {{ cls.room }}</small>
                        </li>
                    </ul>

                    <!-- üëá Fallback when no classes -->
                    <ng-template #noClasses>
                        <div class="text-center text-muted my-4">
                            <i class="bi bi-calendar-x fs-1"></i>
                            <p class="mt-2 mb-0">B·∫°n kh√¥ng c√≥ l·ªõp n√†o h√¥m nay.</p>
                            <small>H√£y ki·ªÉm tra l·ªãch h·ªçc cho c√°c ng√†y ti·∫øp theo.</small>
                        </div>
                    </ng-template>

                    <button (click)="navigateToStudentCalendat()" class="btn btn-outline-secondary btn-sm mt-3">
                        Xem t·∫•t c·∫£ l·ªãch h·ªçc
                    </button>
                </div>
            </div>


        </div>

        <!-- Upcoming Exams -->
        <!-- Upcoming Exams -->
        <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">L·ªãch thi s·∫Øp t·ªõi</h5>

                    <ul class="list-group list-group-flush" *ngIf="upcomingExams.length > 0; else noExams">
                        <li class="list-group-item" *ngFor="let exam of upcomingExams">
                            <strong>{{ exam.subject }}</strong><br>
                            <small>Ng√†y {{ exam.date }} - Ph√≤ng {{ exam.room }} - Gi·ªù {{ exam.time }}</small>
                        </li>
                    </ul>

                    <!-- üëá Fallback when no exams -->
                    <ng-template #noExams>
                        <div class="text-center text-muted my-4">
                            <i class="bi bi-calendar2-event fs-1"></i>
                            <p class="mt-2 mb-0">Ch∆∞a c√≥ l·ªãch thi s·∫Øp t·ªõi.</p>
                            <small>H√£y ki·ªÉm tra l·∫°i sau ho·∫∑c li√™n h·ªá gi·∫£ng vi√™n.</small>
                        </div>
                    </ng-template>

                    <button (click)="navigateToStudentCalendat()" class="btn btn-outline-danger btn-sm mt-3">Xem l·ªãch thi</button>
                </div>
            </div>
        </div>

    </div>

    <!-- GPA Trend Chart Placeholder -->
    <div class="row mb-4 ml-5">
        <div class="col-md-6">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Xu h∆∞·ªõng GPA</h5>
                    <!-- Placeholder chart -->
                    <p>3.1 ‚Üí 3.4 ‚Üí 3.5 ‚Üí 3.56</p>
                    <small class="text-muted">(S·∫Ω thay b·∫±ng bi·ªÉu ƒë·ªì th·ª±c t·∫ø sau)</small>
                </div>
            </div>
        </div>

        <!-- Course Registration -->
        <div class="col-md-6">
            <!-- Attendance Summary -->
            <div class="card ">
                
                    <app-attendance-visualization [attendanceRecords]="attendanceRecords"></app-attendance-visualization>
                    <!-- <a routerLink="/attendance" class="btn btn-outline-primary btn-sm mt-3 ">Xem chi ti·∫øt ƒëi·ªÉm
                        danh</a>
              -->
            </div>


        </div>
    </div>
</div>